---
phase: 10-error-handling-hardening
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - GA-AppLocker/GUI/Panels/Dashboard.ps1
  - GA-AppLocker/GUI/Panels/ADDiscovery.ps1
  - GA-AppLocker/GUI/Panels/Rules.ps1
  - GA-AppLocker/GUI/Panels/Scanner.ps1
  - GA-AppLocker/GUI/Panels/Policy.ps1
  - GA-AppLocker/GUI/Panels/Deploy.ps1
  - GA-AppLocker/GUI/Panels/Software.ps1
  - GA-AppLocker/GUI/Panels/Credentials.ps1
  - GA-AppLocker/GUI/Panels/Setup.ps1
  - GA-AppLocker/GUI/Panels/EventViewer.ps1
autonomous: true
requirements:
  - ERR-01

must_haves:
  truths:
    - "Every catch block in GUI/Panels files contains a Write-AppLockerLog call with function context"
    - "No empty catch blocks remain in any of the 10 GUI Panel files"
    - "Error log messages include the panel name and operation that failed"
  artifacts:
    - path: "GA-AppLocker/GUI/Panels/Dashboard.ps1"
      provides: "20 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/ADDiscovery.ps1"
      provides: "19 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Rules.ps1"
      provides: "30 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Scanner.ps1"
      provides: "14 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Policy.ps1"
      provides: "4 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Deploy.ps1"
      provides: "5 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Software.ps1"
      provides: "6 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Credentials.ps1"
      provides: "1 empty catch replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/Setup.ps1"
      provides: "3 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Panels/EventViewer.ps1"
      provides: "3 empty catches replaced with contextual logging"
  key_links:
    - from: "GUI/Panels/*.ps1 catch blocks"
      to: "Write-AppLockerLog"
      via: "catch { Write-AppLockerLog -Message ... -Level DEBUG/WARN/ERROR }"
      pattern: "catch\\s*\\{\\s*Write-AppLockerLog"
---

<objective>
Replace all 105 empty catch blocks across 10 GUI Panel files with contextual Write-AppLockerLog calls.

Purpose: GUI panels are the operator-facing surface. Silent catch swallowing hides scan failures, rule load errors, filter exceptions, and navigation bugs from the log file. Operators and support engineers cannot diagnose issues when errors are silently discarded.

Output: All 10 GUI Panel .ps1 files updated with contextual error logging in every catch block.
</objective>

<execution_context>
@/home/anthonyscry/.claude/get-shit-done/workflows/execute-plan.md
@/home/anthonyscry/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@GA-AppLocker/GUI/Panels/Dashboard.ps1
@GA-AppLocker/GUI/Panels/ADDiscovery.ps1
@GA-AppLocker/GUI/Panels/Rules.ps1
@GA-AppLocker/GUI/Panels/Scanner.ps1
@GA-AppLocker/GUI/Panels/Policy.ps1
@GA-AppLocker/GUI/Panels/Deploy.ps1
@GA-AppLocker/GUI/Panels/Software.ps1
@GA-AppLocker/GUI/Panels/Credentials.ps1
@GA-AppLocker/GUI/Panels/Setup.ps1
@GA-AppLocker/GUI/Panels/EventViewer.ps1
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace empty catches in high-count panel files (Dashboard, ADDiscovery, Rules, Scanner)</name>
  <files>
    GA-AppLocker/GUI/Panels/Dashboard.ps1
    GA-AppLocker/GUI/Panels/ADDiscovery.ps1
    GA-AppLocker/GUI/Panels/Rules.ps1
    GA-AppLocker/GUI/Panels/Scanner.ps1
  </files>
  <action>
For each empty catch block (`catch { }`) in these 4 files (total ~83 instances):

1. Read the surrounding try block to understand what operation is being attempted
2. Replace the empty catch body with a Write-AppLockerLog call using this pattern:

```powershell
catch {
    Write-AppLockerLog -Message "[PanelName] Failed to <operation description>: $_" -Level DEBUG
}
```

Level selection rules:
- **DEBUG** for UI cosmetic operations (FindName lookups, DataGrid column sizing, tooltip setting, color/brush application, visual state toggles) — these fail silently by design in WPF and logging at WARN would noise up production logs
- **WARN** for data operations that have fallback behavior (filter application, sort, refresh that retries)
- **ERROR** for operations that lose data or leave UI in broken state (save failures, load failures with no fallback)

The panel name prefix MUST match: `[Dashboard]`, `[ADDiscovery]`, `[Rules]`, `[Scanner]`

The operation description MUST be specific to the try block context — not generic "operation failed". Examples:
- `[Dashboard] Failed to update rule count badge: $_`
- `[ADDiscovery] Failed to populate OU tree: $_`
- `[Rules] Failed to apply text filter: $_`
- `[Scanner] Failed to update scan progress bar: $_`

Do NOT change any logic, control flow, or return values. Only add the logging line inside the catch body.
Do NOT touch catch blocks that already contain Write-AppLockerLog or any other statement — only truly empty `catch { }` blocks.
  </action>
  <verify>
Run: `grep -cP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Panels/Dashboard.ps1 GA-AppLocker/GUI/Panels/ADDiscovery.ps1 GA-AppLocker/GUI/Panels/Rules.ps1 GA-AppLocker/GUI/Panels/Scanner.ps1`
Each file should return 0.
  </verify>
  <done>All empty catch blocks in Dashboard.ps1 (20), ADDiscovery.ps1 (19), Rules.ps1 (30), and Scanner.ps1 (14) contain contextual Write-AppLockerLog calls with panel name prefix and operation description.</done>
</task>

<task type="auto">
  <name>Task 2: Replace empty catches in remaining panel files (Policy, Deploy, Software, Credentials, Setup, EventViewer)</name>
  <files>
    GA-AppLocker/GUI/Panels/Policy.ps1
    GA-AppLocker/GUI/Panels/Deploy.ps1
    GA-AppLocker/GUI/Panels/Software.ps1
    GA-AppLocker/GUI/Panels/Credentials.ps1
    GA-AppLocker/GUI/Panels/Setup.ps1
    GA-AppLocker/GUI/Panels/EventViewer.ps1
  </files>
  <action>
For each empty catch block (`catch { }`) in these 6 files (total ~22 instances):

Apply the same pattern as Task 1:

```powershell
catch {
    Write-AppLockerLog -Message "[PanelName] Failed to <operation description>: $_" -Level DEBUG
}
```

Same level selection rules as Task 1 (DEBUG for UI cosmetic, WARN for data with fallback, ERROR for data loss).

Panel name prefixes: `[Policy]`, `[Deploy]`, `[Software]`, `[Credentials]`, `[Setup]`, `[EventViewer]`

Do NOT change any logic, control flow, or return values.
Do NOT touch catch blocks that already contain statements.
  </action>
  <verify>
Run: `grep -cP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Panels/Policy.ps1 GA-AppLocker/GUI/Panels/Deploy.ps1 GA-AppLocker/GUI/Panels/Software.ps1 GA-AppLocker/GUI/Panels/Credentials.ps1 GA-AppLocker/GUI/Panels/Setup.ps1 GA-AppLocker/GUI/Panels/EventViewer.ps1`
Each file should return 0.

Then run: `grep -cP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Panels/*.ps1`
All 10 files should return 0.
  </verify>
  <done>All empty catch blocks across all 10 GUI Panel files are replaced. Zero empty catches remain in GUI/Panels/.</done>
</task>

</tasks>

<verification>
1. `grep -rP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Panels/` returns no matches
2. `grep -c 'Write-AppLockerLog' GA-AppLocker/GUI/Panels/*.ps1` shows increased count in every file
3. Spot-check 3 files to confirm log messages include panel name prefix and specific operation context
</verification>

<success_criteria>
- Zero empty catch blocks remain in any GUI/Panels/*.ps1 file
- Every new log entry includes panel name prefix in brackets and a description of the failed operation
- No logic, control flow, or return values were changed — only logging was added
</success_criteria>

<output>
After completion, create `.planning/phases/10-error-handling-hardening/10-01-SUMMARY.md`
</output>
