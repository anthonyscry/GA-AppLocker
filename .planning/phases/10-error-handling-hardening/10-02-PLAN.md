---
phase: 10-error-handling-hardening
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - GA-AppLocker/GUI/Helpers/UIHelpers.ps1
  - GA-AppLocker/GUI/Helpers/AsyncHelpers.ps1
  - GA-AppLocker/GUI/Helpers/GlobalSearch.ps1
  - GA-AppLocker/GUI/MainWindow.xaml.ps1
  - GA-AppLocker/GUI/Wizards/RuleGenerationWizard.ps1
autonomous: true
requirements:
  - ERR-02

must_haves:
  truths:
    - "Every catch block in GUI/Helpers files contains a Write-AppLockerLog call with function context"
    - "Every catch block in MainWindow.xaml.ps1 contains contextual logging"
    - "Every catch block in RuleGenerationWizard.ps1 contains contextual logging"
    - "No empty catch blocks remain in any GUI helper, MainWindow, or Wizard file"
  artifacts:
    - path: "GA-AppLocker/GUI/Helpers/UIHelpers.ps1"
      provides: "23 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Helpers/AsyncHelpers.ps1"
      provides: "3 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Helpers/GlobalSearch.ps1"
      provides: "1 empty catch replaced with contextual logging"
    - path: "GA-AppLocker/GUI/MainWindow.xaml.ps1"
      provides: "13 empty catches replaced with contextual logging"
    - path: "GA-AppLocker/GUI/Wizards/RuleGenerationWizard.ps1"
      provides: "9 empty catches replaced with contextual logging"
  key_links:
    - from: "GUI/Helpers/*.ps1 catch blocks"
      to: "Write-AppLockerLog"
      via: "catch { Write-AppLockerLog -Message ... -Level DEBUG }"
      pattern: "catch\\s*\\{\\s*Write-AppLockerLog"
---

<objective>
Replace all 49 empty catch blocks in GUI helper files, MainWindow, and the Rule Generation Wizard with contextual Write-AppLockerLog calls.

Purpose: GUI helpers (async operations, UI utilities, search, theme) and the main window are infrastructure that every panel depends on. Silent failures here cause cascading issues — overlays that never hide, search that silently returns nothing, theme toggles that freeze — with no log trail.

Output: 5 files updated with contextual error logging in every catch block.
</objective>

<execution_context>
@/home/anthonyscry/.claude/get-shit-done/workflows/execute-plan.md
@/home/anthonyscry/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@GA-AppLocker/GUI/Helpers/UIHelpers.ps1
@GA-AppLocker/GUI/Helpers/AsyncHelpers.ps1
@GA-AppLocker/GUI/Helpers/GlobalSearch.ps1
@GA-AppLocker/GUI/MainWindow.xaml.ps1
@GA-AppLocker/GUI/Wizards/RuleGenerationWizard.ps1
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace empty catches in UIHelpers.ps1 and AsyncHelpers.ps1</name>
  <files>
    GA-AppLocker/GUI/Helpers/UIHelpers.ps1
    GA-AppLocker/GUI/Helpers/AsyncHelpers.ps1
    GA-AppLocker/GUI/Helpers/GlobalSearch.ps1
  </files>
  <action>
For each empty catch block (`catch { }`) in these 3 files (total ~27 instances):

1. Read the surrounding try block to understand the operation
2. Replace the empty catch body with a Write-AppLockerLog call:

```powershell
catch {
    Write-AppLockerLog -Message "[UIHelpers] Failed to <operation>: $_" -Level DEBUG
}
```

Prefix rules:
- UIHelpers.ps1 uses `[UIHelpers]`
- AsyncHelpers.ps1 uses `[AsyncHelpers]`
- GlobalSearch.ps1 uses `[GlobalSearch]`

Level selection:
- **DEBUG** for UI cosmetic operations (FindName, brush setting, visibility toggle, layout measurement). UIHelpers is almost entirely UI cosmetic — nearly all catches here should be DEBUG.
- **WARN** for async operations that silently drop results (runspace completion, timer disposal)

IMPORTANT for UIHelpers.ps1: Many of these functions are `global:` scope (required for WPF timer/dispatcher callbacks per CLAUDE.md WPF Scope Rules). The logging function Write-AppLockerLog is available globally since it is exported by the Core module. No scope issues.

Do NOT change any logic, control flow, or return values.
Do NOT touch catch blocks that already contain statements.
  </action>
  <verify>
Run: `grep -cP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Helpers/UIHelpers.ps1 GA-AppLocker/GUI/Helpers/AsyncHelpers.ps1 GA-AppLocker/GUI/Helpers/GlobalSearch.ps1`
Each file should return 0.
  </verify>
  <done>All 27 empty catch blocks in UIHelpers.ps1 (23), AsyncHelpers.ps1 (3), and GlobalSearch.ps1 (1) contain contextual logging.</done>
</task>

<task type="auto">
  <name>Task 2: Replace empty catches in MainWindow.xaml.ps1 and RuleGenerationWizard.ps1</name>
  <files>
    GA-AppLocker/GUI/MainWindow.xaml.ps1
    GA-AppLocker/GUI/Wizards/RuleGenerationWizard.ps1
  </files>
  <action>
For each empty catch block (`catch { }`) in these 2 files (total ~22 instances):

1. Read the surrounding try block to understand the operation
2. Replace the empty catch body with a Write-AppLockerLog call:

```powershell
catch {
    Write-AppLockerLog -Message "[MainWindow] Failed to <operation>: $_" -Level DEBUG
}
```

Prefix rules:
- MainWindow.xaml.ps1 uses `[MainWindow]`
- RuleGenerationWizard.ps1 uses `[RuleWizard]`

Level selection:
- **DEBUG** for navigation, panel switching, XAML element lookups, session save/restore
- **WARN** for operations that affect user data (session state persistence, wizard step validation)

Do NOT change any logic, control flow, or return values.
Do NOT touch catch blocks that already contain statements.
  </action>
  <verify>
Run: `grep -cP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/MainWindow.xaml.ps1 GA-AppLocker/GUI/Wizards/RuleGenerationWizard.ps1`
Each file should return 0.

Then run: `grep -rcP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/` to confirm zero empty catches remain across entire GUI directory.
  </verify>
  <done>All 22 empty catch blocks in MainWindow.xaml.ps1 (13) and RuleGenerationWizard.ps1 (9) contain contextual logging. Zero empty catches remain in any GUI file.</done>
</task>

</tasks>

<verification>
1. `grep -rP 'catch\s*\{?\s*\}' GA-AppLocker/GUI/Helpers/ GA-AppLocker/GUI/MainWindow.xaml.ps1 GA-AppLocker/GUI/Wizards/` returns no matches
2. `grep -c 'Write-AppLockerLog' GA-AppLocker/GUI/Helpers/UIHelpers.ps1` shows increased count
3. Spot-check UIHelpers.ps1 to confirm DEBUG level used for FindName/brush operations
</verification>

<success_criteria>
- Zero empty catch blocks remain in GUI/Helpers/, MainWindow.xaml.ps1, or Wizards/
- Every new log entry includes component prefix and specific operation context
- No logic, control flow, or return values were changed
</success_criteria>

<output>
After completion, create `.planning/phases/10-error-handling-hardening/10-02-SUMMARY.md`
</output>
